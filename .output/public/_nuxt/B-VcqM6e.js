import{e as G,r as k,m as E,o as _,w,B as O,q as M,h as f,D as _e,a3 as Z,l as I,W as de,a4 as R,a5 as pe,a6 as fe,a7 as V,I as we,v as Ee,a8 as Ae,a9 as Se,aa as Pe,ab as Oe,V as je,a0 as Re,b as ze,p as $e,ac as Be,c as Ke,F as De,s as Ze,G as ue,ad as Fe,J as Me,ae as ve,$ as Ve,k as Ge}from"./CByrxgib.js";function Ne(e){return Pe()?(Oe(e),!0):!1}function N(e){return typeof e=="function"?e():f(e)}const We=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Xe=Object.prototype.toString,qe=e=>Xe.call(e)==="[object Object]",Je=()=>{};function Ue(e,o,t=!1){return o.reduce((a,i)=>(i in e&&(!t||e[i]!==void 0)&&(a[i]=e[i]),a),{})}function Ye(e,o={}){if(!we(e))return Ee(e);const t=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const a in e.value)t[a]=Ae(()=>({get(){return e.value[a]},set(i){var v;if((v=N(o.replaceRef))==null||v)if(Array.isArray(e.value)){const s=[...e.value];s[a]=i,e.value=s}else{const s={...e.value,[a]:i};Object.setPrototypeOf(s,Object.getPrototypeOf(e.value)),e.value=s}else e.value[a]=i}}));return t}const W=We?window:void 0;function Qe(e){var o;const t=N(e);return(o=t==null?void 0:t.$el)!=null?o:t}function j(...e){let o,t,a,i;if(typeof e[0]=="string"||Array.isArray(e[0])?([t,a,i]=e,o=W):[o,t,a,i]=e,!o)return Je;Array.isArray(t)||(t=[t]),Array.isArray(a)||(a=[a]);const v=[],s=()=>{v.forEach(h=>h()),v.length=0},m=(h,n,C,L)=>(h.addEventListener(n,C,L),()=>h.removeEventListener(n,C,L)),u=R(()=>[Qe(o),N(i)],([h,n])=>{if(s(),!h)return;const C=qe(n)?{...n}:n;v.push(...t.flatMap(L=>a.map(S=>m(h,L,S,C))))},{immediate:!0,flush:"post"}),y=()=>{u(),s()};return Ne(y),y}const ce={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},He=Object.keys(ce);function ge(e={}){const{target:o=W}=e,t=k(!1),a=k(e.initialValue||{});Object.assign(a.value,ce,a.value);const i=v=>{t.value=!0,!(e.pointerTypes&&!e.pointerTypes.includes(v.pointerType))&&(a.value=Ue(v,He,!1))};if(o){const v={passive:!0};j(o,["pointerdown","pointermove","pointerup"],i,v),j(o,"pointerleave",()=>t.value=!1,v)}return{...Ye(a),isInside:t}}function et(e={}){const{window:o=W,behavior:t="auto"}=e;if(!o)return{x:k(0),y:k(0)};const a=k(o.scrollX),i=k(o.scrollY),v=I({get(){return a.value},set(m){scrollTo({left:m,behavior:t})}}),s=I({get(){return i.value},set(m){scrollTo({top:m,behavior:t})}});return j(o,"scroll",()=>{a.value=o.scrollX,i.value=o.scrollY},{capture:!1,passive:!0}),{x:v,y:s}}const $=k(void 0),X=()=>{function e(t){return $.value===void 0?!1:t===$.value.payload}function o(t){return $.value===void 0?!1:$.value.dropTargets.some(a=>a!==void 0&&t.includes(a))}return{isMoving:e,movingItemCanTarget:o,movingItem:$}},{movingItemCanTarget:tt}=X(),A=Se({}),q=k(void 0),at=I(()=>{var e;return(e=q.value)==null?void 0:e.identifier});R(()=>Reflect.ownKeys(A).filter(e=>tt([e,A[e].group])).filter(e=>A[e].pointerIsAbove).toSorted((e,o)=>A[o].stackLevel-A[e].stackLevel).map(e=>A[e]),e=>{q.value=e.length?e.at(0):void 0});R(()=>q.value,(e,o)=>{e!==o&&(o&&o.leaveList(),e&&e.enterList())});const lt=()=>{function e(t,a,i,v,s,m){A[t]={identifier:t,group:a,stackLevel:i,pointerIsAbove:v,enterList:s,leaveList:m}}function o(t){delete A[t]}return{addList:e,removeList:o,targetedList:at}},D=G({__name:"PointerElement",props:{tag:{type:String,default:"div"}},emits:["pointer-enter","pointer-leave"],setup(e,{expose:o,emit:t}){const a=k(),{x:i,y:v}=ge(),s=I(()=>{const u=a.value.getBoundingClientRect();return i.value>=u.x&&i.value<=u.x+u.width&&v.value>=u.y&&v.value<=u.y+u.height}),m=t;return o({isAbove:s}),de(()=>{R(s,(u,y)=>{u&&!y?m("pointer-enter",a.value):y&&!u&&m("pointer-leave",a.value)})}),(u,y)=>(_(),E(V(e.tag),{ref_key:"PointerElement",ref:a},{default:w(()=>[O(u.$slots,"default",pe(fe(u.$attrs)))]),_:3},512))}}),nt=G({__name:"ArrangeableList",props:{tag:{},listItemTag:{},options:{},list:{},listKey:{},identifier:{},meta:{},group:{},targets:{}},emits:["liftItem","dropItem"],setup(e,{emit:o}){const t=e,a=Symbol(),i=I(()=>t.identifier??a),v={defaultItemClass:"",pickedItemClass:"arrangeable-list__invisible",hoveredOverListClass:"",listTransition:{moveClass:"arrangeable-list__transition-all",leaveActiveClass:"arrangeable-list__absolute"},hoverTransitionClass:"arrangeable-list__transition-all-but-location",hoverClass:"",homingEffect:!0,handle:!1,liftDelay:0},s=I(()=>({...v,...t.options})),m=I(()=>typeof s.value.homingEffect=="boolean"&&s.value.homingEffect?"arrangeable-list__homing-effect":s.value.homingEffect||""),u=ge(),{x:y,y:h}=et(),{movingItem:n,isMoving:C,movingItemCanTarget:L}=X(),{addList:S,removeList:B,targetedList:me}=lt(),T=k(),J=k();let U=0,Y=0,P;const b=k([]),x=I(()=>b.value.map(({payload:l})=>l)||[]);function F(l){const d=[];l.forEach(r=>{const p=t.listKey?b.value.find(({key:c})=>c===r[t.listKey]):b.value.find(({payload:c})=>r===c);p?d.push({...p,payload:r}):d.push({key:t.listKey&&Object.keys(r).includes(t.listKey)?r[t.listKey]:Symbol(),payload:r})}),b.value=d}R(()=>t.list,F,{deep:!0}),R(()=>{var l;return(l=n.value)==null?void 0:l.destination},(l,d)=>{(l==null?void 0:l.identifier)!==i.value&&(d==null?void 0:d.identifier)===i.value&&(b.value=b.value.filter(({payload:r})=>{var p;return r!==((p=n.value)==null?void 0:p.payload)}))});const Q=o,H=l=>{var d,r;if(!n.value||((r=(d=n.value)==null?void 0:d.destination)==null?void 0:r.identifier)!==i.value||C(x.value[l]))return;let p=n.value.destination.index;if(p===void 0&&(p=b.value.findIndex(({payload:c})=>{var z;return c===((z=n.value)==null?void 0:z.payload)})),p===-1)b.value.splice(l,0,{payload:n.value.payload,key:n.value.key});else{const[c]=b.value.splice(p,1);b.value.splice(l,0,c)}n.value.destination.index=l,n.value.destination.listItems=x.value},ye=()=>{var l;if(n.value===void 0)return;const d=x.value.indexOf(n.value.payload);d>=0&&b.value.splice(d,1),((l=n.value.destination)==null?void 0:l.identifier)===i.value&&(n.value.destination=n.value.origin)},he=()=>{n.value&&(x.value.length===0&&(b.value=[{payload:n.value.payload,key:n.value.key}]),n.value.destination={identifier:i.value,type:"list",group:t.group,listItems:x.value,meta:t.meta})},K=(l,d)=>{l&&d.split(" ").forEach(r=>{r&&l.classList.add(r)})},ee=(l,d)=>{l&&d.split(" ").forEach(r=>{r&&l.classList.remove(r)})},be=I(()=>typeof s.value.handle=="string"?s.value.handle:""),ke=(l,{key:d,payload:r})=>{P=l.getBoundingClientRect(),U=u.x.value-P.x,Y=u.y.value-P.y;const p=x.value.indexOf(r),c={identifier:i.value,type:"list",group:t.group,listItems:x.value,index:p};n.value={payload:r,hoverElement:T,origin:c,destination:{...c,meta:t.meta},dropTargets:[t.targets??t.group??i.value].flat(),key:d},ve(()=>{le(),K(T.value,s.value.hoverTransitionClass||""),K(T.value,s.value.hoverClass||""),j(T.value,"transitionend",()=>{ee(T.value,s.value.hoverTransitionClass||"")},{once:!0})}),n.value&&Q("liftItem",Z(n.value))};let te;const ae=(l,d)=>{const{target:r,currentTarget:p}=l;s.value.handle&&(r==null?void 0:r.getAttribute("data-handle"))!==be.value||(te=setTimeout(()=>{ke(p,d)},s.value.liftDelay))},Te=()=>{clearTimeout(te)},le=()=>{var l;g.value=((l=document.getElementById("arrangeable-list-target-element"))==null?void 0:l.getBoundingClientRect())??P,g.value&&(g.value={...g.value,top:g.value.top+h.value,left:g.value.left+y.value,right:g.value.right+y.value,bottom:g.value.bottom+h.value,x:g.value.x+y.value,y:g.value.y+h.value})},g=k(),Ce=()=>{if(n.value===void 0||n.value.origin.identifier!==i.value)return;let l=!1;ve(()=>{le(),K(T.value,s.value.hoverTransitionClass||""),m.value&&K(T.value,m.value);let d=getComputedStyle(T.value).transitionProperty,r=getComputedStyle(T.value).transitionDuration;d!=="none"&&r.split(", ").some(p=>parseFloat(p)>0)&&(l=!0),ee(T.value,s.value.hoverClass||""),l?j(T.value,"transitionend",()=>n.value=void 0,{once:!0}):n.value=void 0}),Q("dropItem",Z(n.value)),F(t.list)};j(document,"pointerup",()=>{Te(),Ce()});const Ie=Symbol(),xe=Symbol(),ie=je("arrangeableListStackLevel",0);Ve("arrangeableListStackLevel",ie+1);const Le=I(()=>me.value===i.value);return de(()=>{S(i.value,t.group,ie,I(()=>{var l;return((l=J.value)==null?void 0:l.isAbove)??!1}),he,ye),F(t.list),document.body.style.touchAction="none"}),Re(()=>{B(i.value),document.body.style.touchAction=""}),(l,d)=>(_(),E(D,{name:"ArrangeableList",ref_key:"listElement",ref:J,tag:l.tag??"ul",class:M(Le.value?s.value.hoveredOverListClass:"")},{default:w(()=>[ze(Be,pe(fe(!f(n)||f(L)([i.value,l.group])?s.value.listTransition:{})),{default:w(()=>[(_(),E(V(l.listItemTag??"li"),{key:f(Ie)},{default:w(()=>[O(l.$slots,"before",{arrangedItems:x.value})]),_:3})),(_(!0),Ke(De,null,Ze(b.value||[],(r,p)=>(_(),E(D,{key:r.key,tag:l.listItemTag??"li",id:f(C)(r.payload)?"arrangeable-list-target-element":void 0,class:M(f(C)(r.payload)?[s.value.defaultItemClass,s.value.pickedItemClass].join(" "):s.value.defaultItemClass),onTouchstart:ue(c=>ae(c,r),["left","prevent"]),onPointerdown:ue(c=>ae(c,r),["left","stop"]),onPointerEnter:c=>H(p)},{default:w(()=>[O(l.$slots,"default",{item:r.payload,arrangedItems:x.value})]),_:2},1032,["tag","id","class","onTouchstart","onPointerdown","onPointerEnter"]))),128)),(_(),E(D,{key:f(xe),tag:l.listItemTag??"li",onPointerEnter:d[0]||(d[0]=r=>H(b.value.length))},{default:w(()=>[O(l.$slots,"after",{arrangedItems:x.value})]),_:3},8,["tag"]))]),_:3},16),f(n)&&f(n).origin.identifier===i.value?(_(),E(Fe,{key:0,ref_key:"hoverElement",ref:T},{default:w(()=>{var r,p,c,z,ne,oe,re,se;return[(_(),E(V(l.listItemTag??"li"),{style:Me([{left:f(u).x.value-f(U)+f(y)+"px",top:f(u).y.value-f(Y)+f(h)+"px",width:((r=f(P))==null?void 0:r.width)+"px",height:((p=f(P))==null?void 0:p.height)+"px","--landingzone-top":((c=g.value)==null?void 0:c.top)+"px","--landingzone-left":((z=g.value)==null?void 0:z.left)+"px","--landingzone-right":((ne=g.value)==null?void 0:ne.right)+"px","--landingzone-bottom":((oe=g.value)==null?void 0:oe.bottom)+"px","--landingzone-width":((re=g.value)==null?void 0:re.width)+"px","--landingzone-height":((se=g.value)==null?void 0:se.height)+"px"},{"z-index":"100000000",position:"absolute"}])},{default:w(()=>[O(l.$slots,"default",{item:f(n).payload})]),_:3},8,["style"]))]}),_:3},512)):$e("",!0)]),_:3},8,["tag","class"]))}}),ot=G({__name:"DropZone",props:{options:{default:()=>({hoverClass:""})},identifier:{default:Symbol()},group:{}},emits:["enterZone","leaveZone"],setup(e,{emit:o}){const t=e,{movingItem:a}=X(),i=k(),v=o,s=()=>{var u,y;((y=(u=a.value)==null?void 0:u.destination)==null?void 0:y.identifier)===t.identifier&&(a.value.destination=void 0,v("leaveZone",Z(a.value)))},m=()=>{var u;a.value&&((u=a.value.destination)==null?void 0:u.identifier)!==t.identifier&&(a.value.dropTargets.includes(t.identifier)||t.group&&a.value.dropTargets.includes(t.group))&&(a.value.destination={identifier:t.identifier,group:t.group,type:"dropzone"},v("enterZone",Z(a.value)))};return(u,y)=>{var h,n;return _(),E(D,_e({onPointerLeave:s,onPointerEnter:m,id:((n=(h=f(a))==null?void 0:h.destination)==null?void 0:n.identifier)===t.identifier?"arrangeable-list-target-element":void 0},u.$attrs,{ref_key:"dropZone",ref:i}),{default:w(()=>{var C,L,S,B;return[O(u.$slots,"default",{isHovering:((L=(C=f(a))==null?void 0:C.destination)==null?void 0:L.identifier)===t.identifier,class:M(((B=(S=f(a))==null?void 0:S.destination)==null?void 0:B.identifier)===t.identifier?u.options.hoverClass:"")})]}),_:3},16,["id"])}}}),rt=()=>{const e=Ge("plans",{verbose:!0,autoFetch:!0});return{getTrail:o=>{const t=[];let a=o;for(;a;){const i=e.data.value.find(v=>v.uuid===a);if(!i)break;t.unshift(i),a=i.parent}return t}}};export{X as U,ot as i,nt as l,rt as u};
