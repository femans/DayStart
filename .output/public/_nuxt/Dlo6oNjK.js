import{e as H,j as M,k as R,r as p,l as z,m as g,w as i,o as d,a as l,b as a,d as _,n as E,g as G,h as n,t as x,c as k,p as C,q as w,F as J,s as K,_ as O}from"./CByrxgib.js";import{u as Q,_ as W,a as X,b as Y,c as Z,d as ee}from"./CNiE35Tx.js";import{u as te,l as se,U as oe}from"./B-VcqM6e.js";const ae={class:"flex w-full flex-row items-center gap-2"},ne={class:"flex w-full flex-row items-center gap-2 text-3xl font-bold"},le={class:"flex w-full select-none flex-row border-b dark:border-black"},re={class:"mr-auto flex items-center"},ie={class:"flex w-full flex-row"},ce={key:0,class:"flex flex-row"},de={class:"flex w-10 justify-center"},xe=H({__name:"index",setup(ue){const{isMoving:$}=oe(),{taskList:V,calculateMovedItemPriority:I}=M(),{getTrail:T}=te(),u=R("plans",{verbose:!0,autoFetch:!0}),{placeholder:U}=Q(),B=async e=>{h.value.add(e.uuid),await u.update(e.uuid,{done:!e.done}).then(()=>setTimeout(()=>h.value.delete(e.uuid),1e4))},c=p(null),D=e=>{c.value===e?(u.update(e,{archived:!1}),c.value=null):c.value=e};function j(e){if(!e.destination)return;const s=e.destination.index??-1;if(s===e.origin.index&&e.destination.identifier===e.origin.identifier)return;const r=I(e.destination.listItems,s);e.payload.priority=r,u.update(e.payload.uuid,{priority:r}).then(()=>{console.log("Item priority updated successfully",u.data.value.find(m=>m.id===e.payload.id))})}const N=p(!1),f=p(!1),h=p(new Set),y=z(()=>V.value.filter(e=>e.done===f.value||h.value.has(e.uuid)).filter(e=>!e.archived||N.value));return(e,s)=>{const r=E,m=G,P=X,L=Y,b=O,q=Z,F=ee,S=W;return d(),g(S,{class:"my-2 w-full overflow-hidden px-6 py-2"},{default:i(()=>[l("div",ae,[l("h1",ne,[a(r,{name:"i-heroicons-clipboard-document-list"}),s[1]||(s[1]=_(" Task list "))]),a(m,{onClick:s[0]||(s[0]=t=>f.value=!n(f))},{default:i(()=>[_(x(n(f)?"show to do":"show done"),1)]),_:1})]),l("div",le,[l("div",re," Tasks: "+x(n(y).length),1),s[2]||(s[2]=l("div",{class:"flex w-10 justify-center p-1 text-xs"}," Hrs ",-1)),s[3]||(s[3]=l("div",{class:"flex w-10 justify-center p-1 text-xs"}," Done? ",-1))]),a(n(se),{list:n(y),options:{listTransition:{},handle:!0,hoverClass:"bg-lime-200"},onDropItem:j},{default:i(({item:t})=>[l("div",ie,[l("div",{class:w(["mr-auto flex select-none items-center font-medium",[t.done?"line-through":"",t.archived?"text-gray-400":"text-gray-700"]])},[a(r,{name:"i-heroicons-ellipsis-vertical",class:"cursor-grab","data-handle":""}),t.archived?(d(),g(P,{key:0,text:"Click 2x to restore from archive"},{default:i(()=>[a(r,{name:n(c)===t.uuid?"i-heroicons-archive-box-x-mark":"i-heroicons-archive-box",class:w(["mr-1 hover:bg-purple-500",n(c)===t.uuid?"bg-purple-500":""]),onClick:o=>D(t.uuid)},null,8,["name","class","onClick"])]),_:2},1024)):C("",!0),a(L,{plan:t},null,8,["plan"]),(d(!0),k(J,null,K([0,-3,-2].map(o=>n(T)(t.uuid).at(o)).filter((o,v,A)=>!!o&&o!==A.at(v-1)),(o,v)=>(d(),k("div",{key:v,class:"flex flex-row items-center text-slate-400"},[a(b,{to:{name:"projects-id",params:{id:o.id}}},{default:i(()=>[_(x(o.title),1)]),_:2},1032,["to"]),a(r,{name:"i-heroicons-chevron-right-16-solid"})]))),128)),a(b,{to:{name:"projects-id",params:{id:t.id}},class:w({"italic text-slate-400 dark:text-slate-600":t.archived,"text-slate-700 dark:text-slate-200":!t.archived})},{default:i(()=>[_(x(t.title),1)]),_:2},1032,["to","class"])],2),n($)(t)?C("",!0):(d(),k("div",ce,[a(q,{class:"mb-1 mr-2 w-8 border-b border-solid border-gray-300 px-1 text-right text-sm outline-none",field:"manhours_required","input-type":"number",plan:t,placeholder:n(U)(t,"manhours_required")},null,8,["plan","placeholder"]),l("div",de,[a(F,{modelValue:t.done,"onUpdate:modelValue":o=>t.done=o,onClick:o=>B(t)},null,8,["modelValue","onUpdate:modelValue","onClick"])])]))])]),_:1},8,["list"])]),_:1})}}});export{xe as default};
